Процедура ОсновныеДействияФормыОК(Кнопка)
	
	СохранитьЗначение(ИмяКласса + ".ФайлШаблоновТекста", ФайлШаблоновТекста);
	ирКэш.Получить().ПолучитьТаблицуШаблоновТекста(ИмяКласса, мСообщенияЧерезПредупреждения, Истина);
	СохранитьЗначение(ИмяКласса + ".ЛиОткрыватьПустойСписок", ЛиОткрыватьПустойСписок);
	СохранитьЗначение(ИмяКласса + ".ЛиАктивизироватьОкноСправкиПриЕгоОткрытии", ЛиАктивизироватьОкноСправкиПриЕгоОткрытии);
	СохранитьЗначение(ИмяКласса + ".ЛиАктивноеВычисление", ЛиАктивноеВычисление);
	СохранитьЗначение(ИмяКласса + ".ИспользоватьПромежуточныеДополнения", ИспользоватьПромежуточныеДополнения);
	СохранитьЗначение(ИмяКласса + ".ПредпочитатьСобственныйКонструкторЗапроса", ПредпочитатьСобственныйКонструкторЗапроса);
	Закрыть();
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	ФайлШаблоновТекста = ВосстановитьЗначение(ИмяКласса + ".ФайлШаблоновТекста");
	ЛиОткрыватьПустойСписок = ВосстановитьЗначение(ИмяКласса + ".ЛиОткрыватьПустойСписок");
	ЛиАктивизироватьОкноСправкиПриЕгоОткрытии = ВосстановитьЗначение(ИмяКласса + ".ЛиАктивизироватьОкноСправкиПриЕгоОткрытии");
	ЛиАктивноеВычисление = ВосстановитьЗначение(ИмяКласса + ".ЛиАктивноеВычисление");
	ИспользоватьПромежуточныеДополнения = ВосстановитьЗначение(ИмяКласса + ".ИспользоватьПромежуточныеДополнения");
	ПредпочитатьСобственныйКонструкторЗапроса = ВосстановитьЗначение(ИмяКласса + ".ПредпочитатьСобственныйКонструкторЗапроса");
	
КонецПроцедуры

Процедура ФайлШаблоновНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	ДиалогФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогФайла.ПолноеИмяФайла = Элемент.Значение;
	ДиалогФайла.Расширение = "st";
	ДиалогФайла.Фильтр = ирНеглобальный.ПолучитьСтрокуФильтраДляВыбораФайлаЛкс("st", "Файл шаблонов текста 1С");
	Если ДиалогФайла.Выбрать() Тогда
		Элемент.Значение = ДиалогФайла.ПолноеИмяФайла;
	КонецЕсли;
	
КонецПроцедуры

Процедура ФайлШаблоновТекстаОткрытие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ТаблицаШаблоновТекста = ирКэш.Получить().ПолучитьТаблицуШаблоновТекста(ИмяКласса, мСообщенияЧерезПредупреждения);
	ТаблицаШаблоновТекста.Сортировать("Шаблон");
	Исследовать(ТаблицаШаблоновТекста, Ложь, Истина);
	
КонецПроцедуры
